exports.id=9824,exports.ids=[9824],exports.modules={62983:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{noSSR:function(){return i},default:function(){return d}});let a=t(50167),r=t(20997);t(16689);let l=a._(t(74830));function n(e){return{default:(null==e?void 0:e.default)||e}}function i(e,s){delete s.webpack,delete s.modules;let t=s.loading;return()=>(0,r.jsx)(t,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}function d(e,s){let t=l.default,a={loading:e=>{let{error:s,isLoading:t,pastDelay:a}=e;return null}};e instanceof Promise?a.loader=()=>e:"function"==typeof e?a.loader=e:"object"==typeof e&&(a={...a,...e});let r=(a={...a,...s}).loader;return(a.loadableGenerated&&(a={...a,...a.loadableGenerated},delete a.loadableGenerated),"boolean"!=typeof a.ssr||a.ssr)?t({...a,loader:()=>null!=r?r().then(n):Promise.resolve(n(()=>null))}):(delete a.webpack,delete a.modules,i(t,a))}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},45780:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var a=t(20997),r=t(83300);let l=function({Component:e,pageProps:s}){return a.jsx(r.ClerkProvider,{...s,children:a.jsx(e,{...s})})}},8290:(e,s,t)=>{"use strict";t.r(s),t.d(s,{Dashboard:()=>l,default:()=>n});var a=t(20997);t(16689),t(69603);var r=t(91506);function l({number_of_evaluations:e,mean_score:s,distinct_users_simulated:t,evaluations:l,total_simulations:n}){let i=l?l.map(e=>({date:new Date(e.last_updated).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),averageScore:e.average_score,simulationRunId:e.simulation_run_id})):[];i.length>0&&i.sort((e,s)=>new Date(e.date)-new Date(s.date));let d=[{name:"Scores per Simulation Run",data:i.map(e=>({x:new Date(e.date).toLocaleString("en-US"),y:e.averageScore.toFixed(4),simulationRunId:e.simulationRunId}))}];return i?(0,a.jsxs)("div",{className:"container",children:[a.jsx("h1",{className:"text-3xl font-bold px-8",children:"Assesement Dashboard"}),(0,a.jsxs)("div",{className:"flex flex-wrap mt-8 gap-2 px-8",children:[(0,a.jsxs)("div",{className:"card bg-gradient-to-r from-gray-700 to-gray-900 text-white p-6 rounded-xl shadow-xl transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("span",{className:"text-sm",children:"Total QA / Evaluation"})}),a.jsx("h2",{className:"text-2xl font-bold mt-2",children:e})]}),(0,a.jsxs)("div",{className:"card bg-gradient-to-r from-gray-700 to-gray-900 text-white p-6 rounded-xl shadow-xl transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("span",{className:"text-sm",children:"Mean Score"})}),a.jsx("h2",{className:"text-2xl font-bold mt-2",children:s})]}),(0,a.jsxs)("div",{className:"card bg-gradient-to-r from-gray-700 to-gray-900 text-white p-6 rounded-xl shadow-xl transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("span",{className:"text-sm",children:"Total Evaluations"})}),a.jsx("h2",{className:"text-2xl font-bold mt-2",children:n})]})]}),a.jsx("div",{className:"chart-container mt-8",children:a.jsx("div",{style:{width:"100%"},children:a.jsx(r.default,{data_series:d,title:"Scores per Simulation Run"})})})]}):a.jsx("div",{children:"Loading..."})}let n=l},59844:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>h});var r=t(20997),l=t(16689);t(39332);var n=t(75526);t(25675);var i=t(83300);t(69603),t(11163);var d=t(99648),o=t(8290),c=t(41664),u=t.n(c),x=e([n,d]);[n,d]=x.then?(await x)():x;let h=({evaluation_id:e})=>{let[s,t]=(0,l.useState)([]),{session:a}=(0,i.useClerk)(),{isLoaded:n,userId:c,sessionId:x,getToken:h,orgId:m}=(0,i.useAuth)(),[p,g]=(0,l.useState)(""),[j,f]=(0,l.useState)(!1),[v,b]=(0,l.useState)(0),[y,N]=(0,l.useState)(""),[w,_]=(0,l.useState)(""),[S,R]=(0,l.useState)(""),[k,A]=(0,l.useState)(0),[D,C]=(0,l.useState)(""),[F,O]=(0,l.useState)(""),[I,q]=(0,l.useState)(!1),[L,E]=(0,l.useState)(0),[J,M]=(0,l.useState)(!1),[P,T]=(0,l.useState)([]),[$,Q]=(0,l.useState)(null),[z,G]=(0,l.useState)([]),U="px-4 py-2 leading-5 text-center bg-gray-50 text-sm text-gray-900 tracking-wider",W="px-6 py-4 leading-5 text-center bg-white text-sm text-gray-900 tracking-wider whitespace-no-wrap leading-5",[X,Y]=(0,l.useState)("asc"),[B,H]=(0,l.useState)(0),K=async()=>{try{if(!$)return;M(!0),f(!0);let e=(await d.default.get("https://ragevals-lively-snowflake-5923-divine-bird-6466.fly.dev/api/evaluation/chat",{params:{org_id:a.lastActiveOrganizationId,user_id:c,skip:0,limit:100,filter_score:B,run_id:parseInt($)}})).data;console.log(e),t(e)}catch(e){console.error("Error fetching QA data:",e)}finally{f(!1),M(!1)}},V=async()=>{try{f(!0);let s=await d.default.get("https://ragevals-lively-snowflake-5923-divine-bird-6466.fly.dev/api/evaluation/id",{params:{user_id:c,org_id:a.lastActiveOrganizationId,evaluation_profile_id:e}}),t=s.data[0];O(t.simulation_name),C(t.evaluation_profile_id),R(t.last_updated),A(t.number_of_evaluations),b(t.average_score),N(t.dataset_name),_(t.endpoint_name),E(t.distinct_users),T(s.data),G(s.data.map(e=>e.run_id)),console.log(s.data),$||Q(s.data[0].run_id)}catch(e){console.error("Error fetching dataset details:",e)}finally{f(!1)}},Z=e=>{let s=[e.score.toFixed(4)],t=s.reduce((e,s)=>e+parseFloat(s),0)/s.length;return isNaN(t)?"N/A":t.toFixed(4)};return((0,l.useEffect)(()=>{V(),K(),console.log($),Q($)},[a,$,B]),a&&e&&D)?r.jsx("main",{className:"p-4 md:p-10 mx-auto max-w-7xl",children:r.jsx("div",{children:a?(0,r.jsxs)("div",{children:[r.jsx("div",{className:"mb-6 flex items-center space-x-4 bg-white p-4 rounded-lg shadow-md",children:z.length>0&&r.jsx(o.Dashboard,{number_of_evaluations:k,mean_score:v.toFixed(4),distinct_users_simulated:L,evaluations:P,total_simulations:z.length})}),(0,r.jsxs)("div",{className:"mb-6 flex items-center space-x-4 bg-white p-4 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"font-bold",children:["Total Chat QA Data: ",r.jsx("span",{className:"text-gray-700 font-normal",children:s.length})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{htmlFor:"simulationRunIdSelect",className:"font-bold",children:"Select Evaluation Run ID:"}),(0,r.jsxs)("select",{id:"simulationRunIdSelect",onChange:e=>{Q(e.target.value)},value:$,className:"border border-gray-300 rounded-md w-36 py-1 text-sm text-gray-700 bg-white hover:border-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Select Run ID"}),z.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),r.jsx("button",{onClick:()=>{K()},className:"bg-gray-900 hover:bg-gray-500 text-white px-4 py-2 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-300 disabled:opacity-50",disabled:j,children:j?"Submitting...":"Filter Scores above Threshold"}),r.jsx("input",{type:"text",value:B,placeholder:"Score Threshold",onChange:e=>{H(e.target.value)},className:"border border-gray-300 rounded-md w-24 px-2 py-1 text-sm text-gray-700 focus:border-blue-500"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-10 gap-2 text-sm",children:[(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("div",{className:"font-bold mb-2",children:"Last evaluation run at:"}),r.jsx("div",{className:"text-gray-700",children:new Date(S).toLocaleString()})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("div",{className:"font-bold mb-2",children:"Dataset:"}),r.jsx("div",{className:"text-gray-700",children:y})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("div",{className:"font-bold mb-2",children:"LLM Endpoint:"}),r.jsx("div",{className:"text-gray-700",children:w})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("div",{className:"font-bold mb-2",children:"Evaluation Name:"}),r.jsx("div",{className:"text-blue-500",children:r.jsx(u(),{href:`/view/simulation/${D}`,children:F})})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("div",{className:"font-bold mb-2",children:"Selected Sim Run Id:"}),r.jsx("div",{className:"text-gray-700",children:$})]})]})}),(0,r.jsxs)("table",{className:"w-full mt-2 border-collapse border table-auto",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:U,children:"Timestamp"}),r.jsx("th",{className:U,children:"Chat Messages"}),(0,r.jsxs)("th",{className:U,onClick:()=>{Y("asc"===X?"desc":"asc");let e=s.slice().sort((e,s)=>{let t=Z(e),a=Z(s);return"asc"===X?t-a:a-t});t(e)},style:{cursor:"pointer"},children:["Mean Score","asc"===X?" ▲":" ▼"]}),r.jsx("th",{className:U,children:"Reference Chunk"})]})}),r.jsx("tbody",{children:s.map(e=>(0,r.jsxs)(l.Fragment,{children:[I===e.id&&r.jsx("tr",{className:"border-b",children:r.jsx("td",{colSpan:4,className:"px-6 py-4 leading-5 bg-white text-sm text-gray-900 tracking-wider whitespace-no-wrap leading-5",children:(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("p",{children:r.jsx("strong",{children:"Reference Chunk:"})}),r.jsx("p",{children:e.reference_chunk})]})})}),(0,r.jsxs)("tr",{className:"border-b",children:[r.jsx("td",{className:W,style:{"vertical-align":"top"},children:new Date(e.timestamp).toLocaleString()}),r.jsx("td",{className:W,children:(0,r.jsxs)("ul",{className:"text-left space-y-4",children:[JSON.parse(e.chat_messages).question_answer&&(0,r.jsxs)("li",{className:"mb-2",children:[r.jsx("strong",{children:"Question:"})," ",JSON.parse(e.chat_messages).question_answer.question,r.jsx("br",{}),r.jsx("strong",{children:"Answer:"})," ",JSON.parse(e.chat_messages).question_answer.answer,r.jsx("br",{}),r.jsx("strong",{children:"App Response:"})," ",e.endpoint_response,r.jsx("br",{}),r.jsx("strong",{children:"Score: "})," ",e.score.toFixed(4),r.jsx("br",{}),r.jsx("strong",{children:"Score Reason:"})," ",e.score_reason??""]}),JSON.parse(e.chat_messages).question_answer&&[...[,,,].keys()].map(s=>JSON.parse(e.chat_messages).question_answer[`follow_up_question_${s+1}`]&&(0,r.jsxs)("li",{children:[(0,r.jsxs)("strong",{children:["Follow-up Question ",s+1,": "]}),JSON.parse(e.chat_messages).question_answer[`follow_up_question_${s+1}`],","," ",r.jsx("br",{}),(0,r.jsxs)("strong",{children:["Follow-up Answer ",s+1,": "]})," ",JSON.parse(e.chat_messages).question_answer[`follow_up_answer_${s+1}`],r.jsx("br",{}),(0,r.jsxs)("strong",{children:["App Response Follow-up Answer ",s+1,": "]})," ",e.endpoint_response,r.jsx("br",{}),r.jsx("strong",{children:"Score: "})," ",e.score.toFixed(4),r.jsx("br",{}),r.jsx("strong",{children:"Score Reason:"})," ",e.score_reason??""]},s+1))]})}),r.jsx("td",{className:W,style:{"vertical-align":"top"},children:Z(e)}),r.jsx("td",{className:W,style:{"vertical-align":"top"},children:r.jsx("button",{className:"text-blue-500 underline cursor-pointer",onClick:()=>q(I===e.id?null:e.id),children:I===e.id?"Collapse Reference":"Expand Reference"})})]})]},e.id))})]})]}):r.jsx("div",{children:j||J?r.jsx(r.Fragment,{}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:["Chat QA data evaluation is in progress for evaluation id - ",r.jsx("span",{className:"font-bold",children:e})]}),r.jsx("button",{className:"bg-gray-700 text-sm text-white px-4 py-2 rounded-md mt-4",onClick:()=>{V(),K()},disabled:j,children:"Refresh"})]})})})}):null};a()}catch(e){a(e)}})},91506:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(20997);t(16689);var r=t(5152);let l=t.n(r)()(()=>Promise.resolve().then(t.t.bind(t,28403,23)),{loadableGenerated:{modules:["view/evaluation/line-chart.js -> react-apexcharts"]},ssr:!1}),n=({data_series:e,title:s})=>{if(!e||!e.length||!e[0].data)return a.jsx("div",{children:"No data available"});let t={chart:{type:"line"},xaxis:{categories:e[0].data.map(e=>e.x)},yaxis:{tickAmount:5,labels:{formatter:function(e){return e?e.toFixed(4):0}}},markers:{size:5,style:"hollow"},stroke:{curve:"smooth",width:2,colors:["#1A202C"]},tooltip:{enabled:!0,custom:function({series:e,seriesIndex:s,dataPointIndex:t,w:a}){let r=a.globals.initialSeries[s].data[t],l=r.simulationRunId;return`<div class="tooltip">
                  <span>Date: ${r.x}</span><br/>
                  <span>Score: ${r.y}</span><br/>
                  <span>Simulation Run Id: ${l}</span>
                </div>`}},grid:{show:!1,padding:{left:0,right:0}},title:{text:s,align:"center",style:{fontSize:"12px",fontWeight:"semibold"},margin:10,offsetX:0,offsetY:0}};return a.jsx(l,{options:t,series:e,type:"line",height:300,style:{marginTop:"4px"}})}},69603:()=>{},74830:(e,s,t)=>{"use strict";e.exports=t(87093).vendored.contexts.Loadable},5152:(e,s,t)=>{e.exports=t(62983)}};